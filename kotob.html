<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ³Ø¹ÙŠØ±Ø© Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ù…Ø¬Ù„Ø§Øª</title>
  <style>
    body {
      font-family: 'Cairo', Tahoma, sans-serif;
      direction: rtl;
      background: linear-gradient(to left, #f4f4f4, #e9f0ff);
      padding: 30px;
      animation: fadeIn 1s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      text-align: center;
      color: #1e88e5;
      margin-bottom: 30px;
      font-size: 26px;
    }

    form {
      max-width: 600px;
      margin: auto;
      background-color: #fff;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }

    form:hover {
      transform: scale(1.01);
    }

    label {
      display: block;
      margin-top: 20px;
      font-weight: bold;
      color: #333;
    }

    select, input {
      width: 100%;
      padding: 12px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    select:focus, input:focus {
      border-color: #1e88e5;
      outline: none;
      box-shadow: 0 0 5px rgba(30, 136, 229, 0.4);
    }

    button {
      margin-top: 30px;
      width: 100%;
      background: linear-gradient(to right, #1e88e5, #42a5f5);
      color: white;
      border: none;
      padding: 14px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background: linear-gradient(to right, #1565c0, #42a5f5);
    }

    .result {
      text-align: center;
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
      color: green;
    }
  </style>
</head>
<body>
  <h2>ğŸ“š ØªØ³Ø¹ÙŠØ±Ø© Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ù…Ø¬Ù„Ø§Øª</h2>
  <form id="pricingForm">
    <label for="size">Ø§Ù„Ù…Ù‚Ø§Ø³:</label>
    <select id="size">
      <option>A4</option>
      <option>A5</option>
      <option>A6</option>
<option>A7</option>
    </select>

    <label for="coverPaper">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ (Ø§Ù„ØºÙ„Ø§Ù):</label>
    <select id="coverPaper">
      <option>Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</option>
    </select>

    <label for="innerPaper">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ:</label>
    <select id="innerPaper">
      <option>Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</option>
    </select>

    <label for="coverLam">Ø³Ù„ÙˆÙØ§Ù† Ø¹Ù„Ù‰ Ø§Ù„ØºÙ„Ø§Ù:</label>
    <select id="coverLam">
      <option>Ù„Ø§Ù…Ø¹</option>
      <option>Ù…Ø·ÙÙŠ</option>
    </select>

    <label for="innerLam">Ø³Ù„ÙˆÙØ§Ù† Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©:</label>
    <select id="innerLam">
      <option>Ù„Ø§Ù…Ø¹</option>
      <option>Ù…Ø·ÙÙŠ</option>
      <option>Ø¨Ø¯ÙˆÙ†</option>
    </select>

    <label for="innerPages">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©:</label>
    <select id="innerPages"></select>

    <label for="coverPages">Ø¹Ø¯Ø¯ ØµÙØ­Ø§Øª Ø§Ù„ØºÙ„Ø§Ù:</label>
    <select id="coverPages">
      <option>2</option>
      <option>4</option>
      <option>8</option>
    </select>

    <label for="quantity">Ø§Ù„ÙƒÙ…ÙŠØ©:</label>
    <input type="number" id="quantity" min="1">

    <button type="submit">Ø§Ø­Ø³Ø¨ Ø§Ù„ØªØ³Ø¹ÙŠØ±Ø©</button>
   <div class="result" id="result">
  <div id="resultMain"></div>
  <div id="resultExtra"></div>
</div>
  </form>

<script>
  const apiUrl = "https://script.google.com/macros/s/AKfycbzN_oVxULWKjN2I7WFBnw1rSyHyiX13GE5W2IEFh6zYqoRB8nmf-p6Npq0iYC7FsxPLPA/exec";

  // ØªØ­Ù…ÙŠÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ±Ù‚
  fetch(apiUrl)
    .then(res => res.json())
    .then(data => {
      const coverSelect = document.getElementById("coverPaper");
      const innerSelect = document.getElementById("innerPaper");
      coverSelect.innerHTML = "";
      innerSelect.innerHTML = "";

      const rows = data["haam"] || [];
      rows.forEach(row => {
        const value = row["Ù†ÙˆØ¹ Ø§Ù„ÙˆØ±Ù‚"];
        if (value && value.trim() !== "") {
          const option1 = document.createElement("option");
          option1.textContent = value;
          coverSelect.appendChild(option1);

          const option2 = document.createElement("option");
          option2.textContent = value;
          innerSelect.appendChild(option2);
        }
      });
    });

  // ØªØ­Ù…ÙŠÙ„ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
  const innerPages = document.getElementById("innerPages");
  for (let i = 4; i <= 500; i += 4) {
    const option = document.createElement("option");
    option.value = option.textContent = i;
    innerPages.appendChild(option);
  }

  // Ø³ÙƒØ±Ø¨Øª ÙƒØ§Ù…Ù„ Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  document.getElementById("pricingForm").addEventListener("submit", function (e) {
    e.preventDefault();

    // Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    const size = document.getElementById("size").value;
    const coverPaper = document.getElementById("coverPaper").value;
    const innerPaper = document.getElementById("innerPaper").value;
    const coverPagesCount = parseInt(document.getElementById("coverPages").value);
    const coverLam = document.getElementById("coverLam").value;
    const innerLam = document.getElementById("innerLam").value;
    const quantity = parseInt(document.getElementById("quantity").value);
    const innerPagesCount = parseInt(document.getElementById("innerPages").value);
    const resultMain = document.getElementById("resultMain");
    const resultExtra = document.getElementById("resultExtra");

    // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    resultMain.innerHTML = "";
    resultExtra.innerHTML = "";

    fetch(apiUrl)
      .then(res => res.json())
      .then(data => {
        const rows = data["haam"] || [];
        const lamData = data["haam%"] || [];

        const foundCoverRow = rows.find(row => row["Ù†ÙˆØ¹ Ø§Ù„ÙˆØ±Ù‚"]?.trim() === coverPaper.trim());
        const foundInnerRow = rows.find(row => row["Ù†ÙˆØ¹ Ø§Ù„ÙˆØ±Ù‚"]?.trim() === innerPaper.trim());

        const coverValue = parseFloat(foundCoverRow?.[size]) || 0;
        const innerValue = parseFloat(foundInnerRow?.[size]) || 0;

        if (!isNaN(coverValue) && !isNaN(innerValue)) {
          let laminationValue = 0;
          let innerLaminationValue = 0;
          const firstRow = lamData[0];

          if (coverLam !== "Ø¨Ø¯ÙˆÙ†" && firstRow && !isNaN(parseFloat(firstRow["Ø³Ù„ÙˆÙØ§Ù† ÙˆØ¬Ù‡ ÙˆØ§Ø­Ø¯ 33"]))) {
            laminationValue = parseFloat(firstRow["Ø³Ù„ÙˆÙØ§Ù† ÙˆØ¬Ù‡ ÙˆØ§Ø­Ø¯ 33"]);
          }

          if (innerLam !== "Ø¨Ø¯ÙˆÙ†" && firstRow && !isNaN(parseFloat(firstRow["Ø³Ù„ÙˆÙØ§Ù† ÙˆØ¬Ù‡ ÙˆØ§Ø­Ø¯ 33"]))) {
            innerLaminationValue = parseFloat(firstRow["Ø³Ù„ÙˆÙØ§Ù† ÙˆØ¬Ù‡ ÙˆØ§Ø­Ø¯ 33"]);
          }

          let divisionFactor = 1;
          if (size === "A4") divisionFactor = 2;
          else if (size === "A5") divisionFactor = 4;
          else if (size === "A6") divisionFactor = 8;

          const finalLaminationCover = laminationValue / divisionFactor;
          const finalLaminationInner = innerLaminationValue / divisionFactor;

          // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
          resultMain.innerHTML = `âœ… ØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­:
ğŸ”¹ Ù‚ÙŠÙ…Ø© Ø§Ù„ØºÙ„Ø§Ù: ${coverValue}
ğŸ”¹ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ: ${innerValue}
ğŸ”¹ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©: ${innerPagesCount}
ğŸ”¹ Ø¹Ø¯Ø¯ ØµÙØ­Ø§Øª Ø§Ù„ØºÙ„Ø§Ù: ${coverPagesCount}
ğŸ”¹ Ø§Ù„ÙƒÙ…ÙŠØ©: ${quantity}
ğŸ”¹ Ø³Ù„ÙˆÙØ§Ù† Ø§Ù„ØºÙ„Ø§Ù: ${finalLaminationCover.toFixed(3)}
ğŸ”¹ Ø³Ù„ÙˆÙØ§Ù† Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ: ${finalLaminationInner.toFixed(3)}`;

          // âœ… Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©:
          const totalInnerLamination = (innerPagesCount * finalLaminationInner).toFixed(3);
          resultExtra.innerHTML += `<br>ğŸ”¹ <span style="color:#1e88e5">ØªÙƒÙ„ÙØ© Ø³Ù„ÙˆÙØ§Ù† Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©:</span> ${totalInnerLamination}`;

          resultExtra.innerHTML += `<br>ğŸ”¹ <span style="color:#1e88e5">ØªÙƒÙ„ÙØ© Ø³Ù„ÙˆÙØ§Ù† Ø§Ù„ØºÙ„Ø§Ù:</span> ${finalLaminationCover.toFixed(3)}`;

          // âœ… Ø­Ø³Ø§Ø¨ ØªÙƒÙ„ÙØ© Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©:
          const Ø§Ù„Ø³Ø¹Ø± = parseFloat(foundInnerRow["Ø§Ù„Ø³Ø¹Ø±"]);
          const Ø§Ù„Ø±Ø²Ù… = parseFloat(foundInnerRow["Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±Ù‚ Ù„ÙƒÙ„ Ø±Ø²Ù…Ø©"]);
          const Ù‚ÙŠÙ…Ø©Ø¯Ø§Ø®Ù„ÙŠ = parseFloat(foundInnerRow[size]);

          if (!isNaN(Ø§Ù„Ø³Ø¹Ø±) && !isNaN(Ø§Ù„Ø±Ø²Ù…) && !isNaN(Ù‚ÙŠÙ…Ø©Ø¯Ø§Ø®Ù„ÙŠ)) {
            const Ø³Ø¹Ø±Ø§Ù„ÙˆØ±Ù‚Ø© = Ø§Ù„Ø³Ø¹Ø± / Ø§Ù„Ø±Ø²Ù… / Ù‚ÙŠÙ…Ø©Ø¯Ø§Ø®Ù„ÙŠ;
            const Ø§Ù„ØªÙƒÙ„ÙØ© = (Ø³Ø¹Ø±Ø§Ù„ÙˆØ±Ù‚Ø© * (innerPagesCount / 2)).toFixed(3);
            resultExtra.innerHTML += `<br>ğŸ”¹ <span style="color:#1e88e5">ØªÙƒÙ„ÙØ© Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©:</span> ${Ø§Ù„ØªÙƒÙ„ÙØ©}`;
          }

         
// âœ… Ø­Ø³Ø§Ø¨ ØªÙƒÙ„ÙØ© Ø¹Ø¯Ø¯ ØµÙØ­Ø§Øª Ø§Ù„ØºÙ„Ø§Ù (Ø§Ù„Ø¥ØµØ¯Ø§Ø±)
const Ø§Ù„Ø³Ø¹Ø±_ØºÙ„Ø§Ù = parseFloat(foundCoverRow["Ø§Ù„Ø³Ø¹Ø±"]);
const Ø§Ù„Ø±Ø²Ù…_ØºÙ„Ø§Ù = parseFloat(foundCoverRow["Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±Ù‚ Ù„ÙƒÙ„ Ø±Ø²Ù…Ø©"]);
const Ù‚ÙŠÙ…Ø©_ØºÙ„Ø§Ù = parseFloat(foundCoverRow[size]);

if (!isNaN(Ø§Ù„Ø³Ø¹Ø±_ØºÙ„Ø§Ù) && !isNaN(Ø§Ù„Ø±Ø²Ù…_ØºÙ„Ø§Ù) && !isNaN(Ù‚ÙŠÙ…Ø©_ØºÙ„Ø§Ù)) {
  const Ø³Ø¹Ø±_Ø§Ù„ÙˆØ±Ù‚Ø©_ØºÙ„Ø§Ù = Ø§Ù„Ø³Ø¹Ø±_ØºÙ„Ø§Ù / Ø§Ù„Ø±Ø²Ù…_ØºÙ„Ø§Ù / Ù‚ÙŠÙ…Ø©_ØºÙ„Ø§Ù;
  const ØªÙƒÙ„ÙØ©_Ø§Ù„ØºÙ„Ø§Ù = (Ø³Ø¹Ø±_Ø§Ù„ÙˆØ±Ù‚Ø©_ØºÙ„Ø§Ù * 2).toFixed(3);
  resultExtra.innerHTML += `<br>ğŸ”¹ <span style="color:#1e88e5">ØªÙƒÙ„ÙØ© Ø¹Ø¯Ø¯ ØµÙØ­Ø§Øª Ø§Ù„ØºÙ„Ø§Ù:</span> ${ØªÙƒÙ„ÙØ©_Ø§Ù„ØºÙ„Ø§Ù}`;
}
 // âœ… Ø³Ø¹Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©:
const totalPages = innerPagesCount + coverPagesCount;
let printingFactor = 1; // A4 by default

if (size === "A5") printingFactor = 0.5;
else if (size === "A6") printingFactor = 0.25;
else if (size === "A7") printingFactor = 0.125;

// âœ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø³Ø¹Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ù…Ù† Ø£ÙˆÙ„ ØµÙ ÙÙŠÙ‡ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø©
const Ø³Ø¹Ø±_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©_Ø§Ù„Ø«Ø§Ø¨Øª = rows.find(r => !isNaN(parseFloat(r["Ø³Ø¹Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© "])));
const Ø³Ø¹Ø±_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© = Ø³Ø¹Ø±_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©_Ø§Ù„Ø«Ø§Ø¨Øª ? parseFloat(Ø³Ø¹Ø±_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©_Ø§Ù„Ø«Ø§Ø¨Øª["Ø³Ø¹Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© "]) : 0;
          
if (!isNaN(Ø³Ø¹Ø±_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©)) {
  let Ù…Ø¹Ø¯Ù„ = 1;
  if (size === "A5") Ù…Ø¹Ø¯Ù„ = 0.5;
  else if (size === "A6") Ù…Ø¹Ø¯Ù„ = 0.25;
  else if (size === "A7") Ù…Ø¹Ø¯Ù„ = 0.125;

  const ØªÙƒÙ„ÙØ©_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© = ((innerPagesCount + coverPagesCount) * Ø³Ø¹Ø±_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© * Ù…Ø¹Ø¯Ù„).toFixed(3);
  resultExtra.innerHTML += `<br>ğŸ”¹ <span style="color:#1e88e5">ØªÙƒÙ„ÙØ© Ø³Ø¹Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©:</span> ${ØªÙƒÙ„ÙØ©_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©}`;
} else {
  resultExtra.innerHTML += `<br>ğŸ”¸ <span style="color:#f39c12">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³Ø¹Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©</span>`;
}
// âœ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
let Ø§Ù„ØªÙƒÙ„ÙØ©_Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© = !isNaN(parseFloat(Ø§Ù„ØªÙƒÙ„ÙØ©)) ? parseFloat(Ø§Ù„ØªÙƒÙ„ÙØ©) : 0;
let Ø§Ù„ØªÙƒÙ„ÙØ©_Ø§Ù„ØºÙ„Ø§Ù = !isNaN(parseFloat(ØªÙƒÙ„ÙØ©_Ø§Ù„ØºÙ„Ø§Ù)) ? parseFloat(ØªÙƒÙ„ÙØ©_Ø§Ù„ØºÙ„Ø§Ù) : 0;
let Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© = !isNaN(parseFloat(ØªÙƒÙ„ÙØ©_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©)) ? parseFloat(ØªÙƒÙ„ÙØ©_Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©) : 0;

const sumTotal = (
  parseFloat(totalInnerLamination) +
  parseFloat(finalLaminationCover.toFixed(3)) +
  Ø§Ù„ØªÙƒÙ„ÙØ©_Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© +
  Ø§Ù„ØªÙƒÙ„ÙØ©_Ø§Ù„ØºÙ„Ø§Ù +
  Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
).toFixed(3);

resultExtra.innerHTML += `<br><br>ğŸ’° <span style="color:#43a047;font-weight:bold">ğŸ“¦ Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©:</span> ${sumTotal} Ø±ÙŠØ§Ù„`; 
          
        } else {
          resultMain.textContent = "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø±Ù‚Ù…ÙŠØ© ØµØ§Ù„Ø­Ø©.";
        }
      })
      .catch(err => {
        resultMain.textContent = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ³Ø¹ÙŠØ±Ø©";
        console.error(err);
      });
  });
</script>

</body>
</html>
